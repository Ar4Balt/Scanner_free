# üîç Stealth Network Scanner

–ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã–π —Å–∫–∞–Ω–µ—Ä –ø–æ—Ä—Ç–æ–≤ –Ω–∞ **C++17** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π TCP Connect Scan, SYN-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (—Ç—Ä–µ–±—É–µ—Ç root), Banner Grabbing –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ **JSON**.
<![image](images/ChatGPT Image 1 —Å–µ–Ω—Ç. 2025 –≥., 23_02_06.png)>

---

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üöÄ **–í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å** ‚Äî –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å (std::thread + –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á).  
- üïµÔ∏è **Stealth-—Ä–µ–∂–∏–º** ‚Äî SYN-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ —Å—ã—Ä—ã–µ —Å–æ–∫–µ—Ç—ã.  
- üì° **Banner Grabbing** ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –±–∞–Ω–Ω–µ—Ä–æ–≤ —Å–µ—Ä–≤–∏—Å–æ–≤.  
- üìÇ **JSON-–≤—ã–≤–æ–¥** ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ.  
- üéØ **–ì–∏–±–∫–æ—Å—Ç—å** ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –ø–æ—Ä—Ç–æ–≤ (`1-1000`) –∏ –æ–¥–∏–Ω–æ—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.  

---

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1. –†—É—á–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è

#### –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
sudo apt update
sudo apt install g++ make cmake nlohmann-json3-dev -y
````

#### –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å

```bash
g++ -o scanner scanner.cpp -pthread -std=c++17
```

---

### –í–∞—Ä–∏–∞–Ω—Ç 2. –°–±–æ—Ä–∫–∞ —á–µ—Ä–µ–∑ CMake

1. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª `CMakeLists.txt` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```cmake
cmake_minimum_required(VERSION 3.10)
project(StealthScanner)

set(CMAKE_CXX_STANDARD 17)

find_package(nlohmann_json 3.2.0 REQUIRED)

add_executable(scanner scanner.cpp)
target_link_libraries(scanner PRIVATE nlohmann_json::nlohmann_json pthread)
```

2. –í—ã–ø–æ–ª–Ω–∏ —Å–±–æ—Ä–∫—É:

```bash
mkdir build && cd build
cmake ..
make
```

3. –ó–∞–ø—É—Å—Ç–∏:

```bash
./scanner -t 192.168.1.1 -p 1-100 -m 50 -o results.json
```

---

## üöÄ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### TCP Connect Scan (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

```bash
./scanner -t 192.168.1.1 -p 1-100 -m 50 -o results.json
```

–°–∫–∞–Ω–∏—Ä—É–µ—Ç –ø–æ—Ä—Ç—ã **1-100** —Å 50 –ø–æ—Ç–æ–∫–∞–º–∏ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ `results.json`.

---

### SYN-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–Ω—É–∂–Ω—ã –ø—Ä–∞–≤–∞ root)

```bash
sudo ./scanner -t 192.168.1.1 -p 1-100 -s
```

–í—ã–ø–æ–ª–Ω—è–µ—Ç stealth-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ—Ç–ø—Ä–∞–≤–∫–∞ SYN-–ø–∞–∫–µ—Ç–æ–≤ –±–µ–∑ –ø–æ–ª–Ω–æ–≥–æ —Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏—è).

---

### Banner Grabbing

```bash
./scanner -t 192.168.1.1 -p 22-25,80,443 -b
```

–ò–∑–≤–ª–µ–∫–∞–µ—Ç –±–∞–Ω–Ω–µ—Ä—ã —Å–µ—Ä–≤–∏—Å–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, SSH, HTTP, SMTP).

---

## üìä –§–æ—Ä–º–∞—Ç JSON-–≤—ã–≤–æ–¥–∞

–ü—Ä–∏–º–µ—Ä `results.json`:

```json
{
    "target": "192.168.1.1",
    "open_ports": [22, 80, 443],
    "timestamp": 1735928475123456
}
```

---

## üîë –û–ø—Ü–∏–∏ –∑–∞–ø—É—Å–∫–∞

| –û–ø—Ü–∏—è          | –û–ø–∏—Å–∞–Ω–∏–µ                              |
| -------------- | ------------------------------------- |
| `-t <target>`  | IP –∏–ª–∏ hostname —Ü–µ–ª–∏                  |
| `-p <ports>`   | –î–∏–∞–ø–∞–∑–æ–Ω –ø–æ—Ä—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `1-1000`)  |
| `-m <threads>` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤                    |
| `-o <file>`    | –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ JSON            |
| `-s`           | –í–∫–ª—é—á–∏—Ç—å SYN-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (root only) |
| `-b`           | –í–∫–ª—é—á–∏—Ç—å Banner Grabbing              |

---

## ‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑—É–π —Å–∫–∞–Ω–µ—Ä **—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–≤–æ–∏—Ö —Å–µ—Ç–µ–π** –∏–ª–∏ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤–ª–∞–¥–µ–ª—å—Ü–∞.
–ê–≤—Ç–æ—Ä –Ω–µ –Ω–µ—Å—ë—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –Ω–µ–ª–µ–≥–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ.